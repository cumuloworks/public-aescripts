var p=this;var d=(p instanceof Panel) ? p : new Window("palette");if ( !(p instanceof Panel) ) d.text="CW Audio Dim Switch";d.orientation="column";d.alignChildren=["center","top"];d.spacing=10;d.margins=16;var dim=d.add("button", undefined, undefined, {name: "dim"});dim.text="DIM";dim.onClick=dimClicked;var credit=d.add("statictext", undefined, undefined, {name: "credit"});credit.text="CW Audio Dim Switch v1.0";credit.justify="center";d.layout.layout(true);d.layout.resize();d.onResizing=d.onResize=function () { this.layout.resize(); }if ( d instanceof Window ) d.show();if (d instanceof Window) d.show();function dimClicked() {if (dim.text=='DIM') {for (i=0; i < app.project.activeItem.layers.length; i++) {if (app.project.activeItem.layers[i + 1].hasAudio==true && !app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").property('(CW Dim)')) {dimFX=app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").addProperty('ADBE Aud Stereo Mixer');dimFX.name='(CW Dim)';dimFX.property('ADBE Aud Stereo Mixer-0001').setValue(20);dimFX.property('ADBE Aud Stereo Mixer-0002').setValue(20);}}for (i=0; i < app.project.activeItem.layers.length; i++) {if (app.project.activeItem.layers[i + 1].hasAudio==true && app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").property('(CW Dim)')) {dim.text="DIMMED";}}} else {noCWDS=true;for (i=0; i < app.project.activeItem.layers.length; i++) {if (app.project.activeItem.layers[i + 1].hasAudio==true && app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").property('(CW Dim)')) {app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").property('(CW Dim)').remove();}}for (i=0; i < app.project.activeItem.layers.length; i++) {if (app.project.activeItem.layers[i + 1].hasAudio==true && app.project.activeItem.layers[i + 1].property("ADBE Effect Parade").property('(CW Dim)')) {noCWDS=false;}}if(noCWDS==true){dim.text="DIM";}}}